<!DOCTYPE html>
<html lang="es">
    <head>
        <title>Prueba de velocidad API Rest</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    </head>
    <body>
        <header>

        </header>
        <section>
            <p id="message"></p>
            <canvas id="canva" width="640px" height="480px"></canvas>
            <div class="text"></div>
        </section>
    </body>
    <script type="text/javascript" src="frames/tmp/FramesChunk_01.json"></script>
    <script type="text/javascript">

        /*
        const TXT_URL = 'https://www.mozilla.org/media/MPL/2.0/index.815ca599c9df.txt';

        $.ajax
        (
            {
                url : TXT_URL,
                dataType: "text",
                success : function (data) 
                {
                    $(".text").html("<pre>"+data+"</pre>");
                }
            }
        );*/
        const frameChunk = JSON.parse(frames);

        var canvas = document.getElementById("canva");
        var ctx = canvas.getContext("2d");

        let initTime =  frameChunk[0].time*1;
        frameChunk.forEach((element,index) => {
            
            var image = new Image();
            image.src = "data:image/jpg;base64," +element.image;
            image.onload = () => {
                const displayTime = element.time - initTime;
                setTimeout(() => {
                    ctx.drawImage(image, 0, 0);
                    //console.info(element.frameIndex);
                }, displayTime);
            };
        });

        console.log(frameChunk.length/(frameChunk[frameChunk.length-1].time*1 - initTime)*1000);

        
    </script>
</html>